<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LED Banner</title>
    <style>
        body { background: #000; margin: 0; display: flex; align-items: center; height: 100vh; }

        /* The Screen */
        .led-screen {
            position: relative;
            width: 100%;
            height: 250px;
            background: #050505;
            border-top: 4px solid #222;
            border-bottom: 4px solid #222;
            overflow: hidden;
            display: flex;
            align-items: center;
        }

        /* The Scrolling Text */
        #bannerText {
            position: absolute;
            white-space: nowrap;
            font-family: 'Courier New', monospace;
            font-weight: 900;
            text-transform: uppercase;
            color: #ff0000; /* Fallback color */
            font-size: 150px;
            text-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
            will-change: transform;
        }

        /* The Mesh Overlay (makes it look pixelated) */
        .led-screen::after {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: radial-gradient(rgba(0,0,0,0.8) 40%, transparent 45%);
            background-size: 6px 6px;
            z-index: 10;
            pointer-events: none;
        }

        /* Animation */
        @keyframes scroll {
            from { transform: translateX(100vw); }
            to { transform: translateX(-100%); }
        }
    </style>
</head>
<body>

    <div class="led-screen">
        <div id="bannerText">WAITING FOR SHEET...</div>
    </div>

    <script>
        const SCRIPT_URL = 'YOUR_DEPLOYED_EXEC_URL';

        async function update() {
            try {
                const resp = await fetch(SCRIPT_URL + '?t=' + Date.now());
                const data = await resp.json();
                console.log("Sheet Data:", data);

                const el = document.getElementById('bannerText');
                
                // Update Content
                el.innerText = data.text || "NO TEXT FOUND";
                
                // Update Style
                el.style.color = data.color || "#ff0000";
                el.style.fontSize = (data.size || 150) + "px";
                
                // Update Animation
                const speed = data.speed || 10;
                el.style.animation = `scroll ${speed}s linear infinite`;
                
                if(data.direction === 'right') {
                    el.style.animationDirection = 'reverse';
                }

            } catch (e) {
                console.error("Update failed", e);
            }
        }

        // Check for changes every 15 seconds
        setInterval(update, 15000);
        update();
    </script>
</body>
</html>